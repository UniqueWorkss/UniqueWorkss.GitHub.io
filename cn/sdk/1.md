ä¸ºä»€ä¹ˆè¦è¿›è¡ŒXPçš„æ’ä»¶å¼€å‘ï¼š

> ç¬”è€…ä¹‹å‰ä»äº‹è¿‡DCSçš„æ’ä»¶å¼€å‘ï¼Œä¸»è¦ç”¨äºæˆ˜æœ¯æ¨¡æ‹Ÿä»¥åŠé£æ§æµ‹è¯•ã€‚ä½†ç”±äºDCSçš„å†å²æ€§åŸå› ï¼Œå…¶æ–‡æ¡£è¾ƒä¸ºè€æ—§ä¸”é™„å¸¦å¤§é‡ä¿„è¯­ã€‚åšä¸€äº›ç®€å•çš„æ’ä»¶å°šå¯ï¼Œä½†è¦è¿›è¡Œå¤æ‚çš„å¼€å‘åˆ™è¾ƒä¸ºå›°éš¾ã€‚XPä½œä¸ºå†›æ°‘ä¸¤ç”¨èˆªç©ºæ¨¡æ‹Ÿå™¨çš„ä½¼ä½¼è€…ï¼Œæä¾›äº†å®æ—¶è®¡ç®—çš„ç©ºæ°”åŠ¨åŠ›å­¦æ•°æ®ä»¥åŠæœ€æ¥è¿‘çœŸå®çš„é£è¡Œæ¨¡æ‹Ÿä½“éªŒã€‚ç¬”è€…çš„ç»ˆæç›®æ ‡æ˜¯æƒ³å°è¯•åšä¸€äº›XPå‘¨è¾¹çš„è½¯ç¡¬ä»¶ï¼Œå¦‚å®¶åº­åº§èˆ±ï¼Œé£æ§ç®—æ³•æµ‹è¯•ç­‰ã€‚
> 

X-Plane (XP) æä¾›äº†å®˜æ–¹SDKï¼ˆSoftware Development Kitï¼Œè½¯ä»¶å¼€å‘åŒ…ï¼‰ï¼Œä¸ºæ’ä»¶å¼€å‘æä¾›äº†è‰¯å¥½çš„ç¯å¢ƒã€å…¨é¢çš„æ–‡æ¡£ã€‚**æ’ä»¶ä½¿ç”¨C++ç¼–å†™**ï¼Œä¸º.xplåç¼€çš„åŠ¨æ€é“¾æ¥åº“å½¢å¼**ã€‚**å…¶ä¸­ä¸€äº›è¾ƒä¸ºè‘—åä¸”å¸¸ç”¨çš„æ’ä»¶åŒ…æ‹¬ï¼š

- BetterPushback: æ¨å‡º
- BetterMouseYoke: é¼ æ ‡æ‘‡æ†
- AviTab: é£è¡Œå¹³æ¿
- DataRefTool / DataRefEditor: é£è¡Œå‚æ•°æŸ¥æ‰¾åŠä¿®æ”¹
- FlyWithLua: Luaæ¥å£æ’ä»¶å¼€å‘çš„ä¸­é—´ä»¶

<aside>
ğŸ’¡ å…¶ä¸­ FlyWithLua æä¾›äº†ä½¿ç”¨Luaè¿›è¡Œæ’ä»¶å¼€å‘çš„æ¥å£ï¼Œä¾‹å¦‚BetterMouseYokeå°±æ˜¯åŸºäºLuaå¼€å‘ã€‚è‹¥æ‚¨æƒ³å‚è€ƒæ›´å¤šæœ‰å…³èµ„æ–™ï¼Œè¯·æŸ¥é˜…ï¼šFlyWithLua ã€‚æœ¬æ•™ç¨‹ä½¿ç”¨XPåŸç”ŸSDKè¿›è¡Œæ’ä»¶å¼€å‘ï¼Œä¸ä¼šæ¶‰åŠLuaã€‚ ç”¨FlyWithLua çš„å¥½å¤„ï¼Œèƒ½æ›´å¿«åœ°å¼€å‘ä¸€äº›è·¨å¹³å°çš„æ’ä»¶ï¼ˆç”±äºç”¨Luaç¼–å†™ä¸æ¶‰åŠç³»ç»Ÿç¯å¢ƒï¼‰ã€‚
</aside>

ç›®å‰äº†è§£åˆ°çš„è‡³å°‘éœ€è¦ç†Ÿæ‚‰ä»¥ä¸‹æŠ€èƒ½ç‚¹ï¼š

- åˆçº§C++
- ç†Ÿæ‚‰Visual Studio ï¼ˆ2017åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰ä½œä¸ºC++å¼€å‘çš„IDLE
- Windows 10/11ç³»ç»Ÿï¼Œå°šæœªæ¥è§¦è¿‡Linuxæˆ–è€…Macä¸‹çš„æ’ä»¶å¼€å‘

å‚è€ƒèµ„æ–™ï¼š

1. @alirezaghaderi upä¸»çš„ç³»åˆ—è¯¾ç¨‹ï¼ˆyoutubeï¼‰
2. XPå®˜æ–¹å¼€å‘æ•™ç¨‹ï¼š[https://developer.x-plane.com/](https://developer.x-plane.com/)

---

**SDKçš„å®‰è£…ä»¥åŠç¬¬ä¸€ä¸ªæ’ä»¶ç¤ºä¾‹: Hello X-Plane**

æ•ˆæœå›¾ï¼š

![Untitled](https://picdx.sunbangyan.cn/2023/06/30/kffcky.png)

ï¼ˆè¯¥æ’ä»¶å°†å»ºç«‹ä¸€ä¸ªçª—å£å¹¶æ˜¾ç¤ºæ–‡å­—ï¼‰

è¯¦ç»†æ­¥éª¤ï¼š

### é¢„å¤‡å·¥ä½œ

ä¸‹è½½å¹¶å®‰è£…Visual Studio ï¼ˆ2017åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰ï¼Œå¹¶å®‰è£…ç›¸åº”Windowsä¸‹å¼€å‘C++çš„å·¥å…·é“¾ã€‚

<aside>
ğŸ’¡ è‹¥ä½¿ç”¨Macæˆ–è€…Linuxç³»ç»Ÿï¼Œä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„XCodeæˆ–è€…gccä¹Ÿå¯ï¼Œä½†åç»­çš„é…ç½®å·¥ä½œå¯èƒ½ç¨ä¸ºç¹çã€‚
## ä¸‹è½½X-Planeå®˜ç½‘çš„SDKå¼€å‘åŒ…

[https://developer.x-plane.com/sdk/plugin-sdk-downloads/](https://developer.x-plane.com/sdk/plugin-sdk-downloads/)

æ³¨æ„å¯¹åº”çš„ç‰ˆæœ¬ã€‚å¦‚æœä½¿ç”¨XP10åˆ™ä¸‹è½½XPLM300å³å¯ã€‚

![Untitled 1](https://picsx.sunbangyan.cn/2023/06/30/kffs3i.png)![Untitled 2](https://picdo.sunbangyan.cn/2023/06/30/kffz8m.png)

ä¸‹è½½å®Œæˆå¹¶è§£å‹å¾—åˆ°ä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼š

![Untitled 3](https://picdv.sunbangyan.cn/2023/06/30/kfg3zu.png)

### ä¸‹è½½XPå®˜ç½‘ç¤ºä¾‹é¡¹ç›®

æœ¬ç¤ºä¾‹ä½¿ç”¨çš„æ˜¯XPå®˜ç½‘æä¾›çš„â€œHelloWorldâ€é¡¹ç›®ï¼š[https://developer.x-plane.com/sdk/plugin-sdk-sample-code/](https://developer.x-plane.com/sdk/plugin-sdk-sample-code/)

![Untitled 4](https://picsl.sunbangyan.cn/2023/06/30/kfgy3h.png)

ä¸‹è½½VSç‰ˆæœ¬

![Untitled 5](https://picdy.sunbangyan.cn/2023/06/30/kfh6fg.png)

è§£å‹å¹¶æ‰“å¼€VSé¡¹ç›®

![Untitled 6](https://picdg.sunbangyan.cn/2023/06/30/kfh8f8.png)

<aside>
ğŸ’¡ è‹¥ä½¿ç”¨VS2017ä»¥ä¸Šç‰ˆæœ¬åˆ™ä¼šæç¤ºå‡çº§å·¥å…·é›†ï¼Œç›´æ¥å‡çº§åˆ°æœ€æ–°å³å¯ã€‚
</aside>

![Untitled 7](https://picsj.sunbangyan.cn/2023/06/30/kfhgcl.png)

æ‰“å¼€Hello-World-SDK-3.cppæ–‡ä»¶ï¼š

![Untitled 8](https://picdu.sunbangyan.cn/2023/06/30/kfi44d.png)

### æ„å»ºé¡¹ç›®

é¡¹ç›®ç›®å½•ä¸­æœ‰ä¸€ä¸ªSDKæ–‡ä»¶å¤¹ï¼Œå®é™…ä¸Šå°±æ˜¯æˆ‘ä»¬ç¨æ—©å‰ä¸‹è½½çš„SDKåŒ…ã€‚å¦‚æœæ²¡æœ‰çš„è¯æˆ–è€…ç‰ˆæœ¬ä¸å¯¹æ‰‹åŠ¨æ·»åŠ å³å¯ã€‚æ³¨æ„ç›®å½•ã€‚

![Untitled 9](https://picsa.sunbangyan.cn/2023/06/30/kfi4ao.png)

æ„å»ºé¡¹ç›®å‰éœ€è¦å…ˆæ£€æŸ¥é…ç½®ï¼šå³é”®é¡¹ç›®å-å±æ€§

<aside>
ğŸ’¡ ä½¿ç”¨Debugæˆ–è€…Releaseé…ç½®å‡å¯ï¼Œæ³¨æ„ä¿æŒé…ç½®å±æ€§å’Œå®é™…æ„å»ºæ—¶çš„å±æ€§ä¸€è‡´ã€‚å»ºè®®ç›´æ¥ä½¿ç”¨é»˜è®¤çš„Debugé…ç½®ã€‚
</aside>

![Untitled 10](https://picse.sunbangyan.cn/2023/06/30/kfijph.png)

C/C++-å¸¸è§„-é™„åŠ åŒ…å«ç›®å½•ï¼Œå‘ç°å·²ç»é…ç½®å¥½äº†SDKä¸­çš„å¤´æ–‡ä»¶çš„XPLMä»¥åŠWidgetsç›®å½•ã€‚

![Untitled 11](https://picdt.sunbangyan.cn/2023/06/30/kfj2vu.png)

æ¥ä¸‹æ¥ï¼Œé“¾æ¥å™¨-å¸¸è§„ï¼šå·²ç»é…ç½®å¥½äº†SDKæ–‡ä»¶å¤¹ä¸­çš„é“¾æ¥åº“Libraries-Winï¼ˆå¦‚æœæ˜¯Macå¹³å°å°±æ·»åŠ Macæ–‡ä»¶å¤¹ï¼‰

![Untitled 12](https://picdo.sunbangyan.cn/2023/06/30/kfj8ox.png)

æ­¤æ—¶é…ç½®å®Œæˆï¼Œå¯ä»¥é‡æ–°ç”Ÿæˆè§£å†³æ–¹æ¡ˆï¼š

![Untitled 13](https://picsq.sunbangyan.cn/2023/06/30/kfjh0r.png)

ç”Ÿæˆçš„æ’ä»¶åœ¨é¡¹ç›®çš„Debug-plugins æ–‡ä»¶å¤¹å†…ï¼Œé‡Œé¢åŒ…å«äº†64å¹³å°ä¸‹çš„.xplæ–‡ä»¶

![Untitled](Part%201%20-%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E4%BB%8B%E7%BB%8D%2061d09d19690c4856810e2b36029b5e4a/Untitled%2014.png)

æ¥ä¸‹æ¥ç”¨æ­£å¸¸æ–¹æ³•å®‰è£…æ’ä»¶å³å¯ï¼Œå°†ç”Ÿæˆçš„Hello-World-SDK-3æ–‡ä»¶å¤¹æ”¾åˆ°X-Plane11ä¸»ç›®å½•çš„Resources-Pluginsæ–‡ä»¶å¤¹ä¸‹ã€‚ä¹Ÿå¯ä»¥æ”¾ç½®åˆ°æŸæœºå‹æ–‡ä»¶å¤¹çš„Pluginsæ–‡ä»¶å¤¹å†…ï¼Œä¾‹å¦‚ç¬”è€…æ”¾åˆ°äº†Cessna 172ä¸­ï¼Œè¿™æ ·è¯¥æ’ä»¶å°±åªå¯¹è¯¥ç‰¹å®šæœºå‹æœ‰æ•ˆã€‚

![Untitled](Part%201%20-%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E4%BB%8B%E7%BB%8D%2061d09d19690c4856810e2b36029b5e4a/Untitled%2015.png)

### è¿è¡Œæ•ˆæœ

æ‰“å¼€XPï¼Œé€‰æ‹©C172ï¼ˆè‹¥é‡‡ç”¨ç¬¬äºŒç§æ’ä»¶å®‰è£…æ–¹æ³•ï¼‰

![Untitled](Part%201%20-%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E4%BB%8B%E7%BB%8D%2061d09d19690c4856810e2b36029b5e4a/Untitled%2016.png)

è‡³æ­¤å®‰è£…æˆåŠŸï¼

### ä»£ç è§£é‡ŠåŠä¿®æ”¹

ä¸»ç¨‹åºä»£ç ä¸€å…±ä¸€ç™¾å¤šè¡Œï¼Œç›®çš„æ˜¯æ„å»º.xplè¿™ä¸ªåŠ¨æ€é“¾æ¥åº“ã€‚å…¶ä¸­åŒ…å«äº†åˆ›å»ºçª—å£ï¼Œæ·»åŠ æ–‡å­—ç­‰ã€‚ç¬”è€…è®¤ä¸ºæ²¡æœ‰å¿…è¦å®Œå…¨ææ‡‚æ¯ä¸€è¡Œä»£ç çš„æ„æ€ï¼Œé‡è¦çš„æ˜¯èƒ½æŠŠé¡¹ç›®æ„å»ºæµç¨‹å…ˆææ‡‚ï¼Œèƒ½å¤Ÿåœ¨æºä»£ç ä¸Šç¨å¾®ä¿®æ”¹ä¸»è¦åŠŸèƒ½å³å¯ã€‚

```cpp
// Downloaded from https://developer.x-plane.com/code-sample/hello-world-sdk-3/

#include "XPLMDisplay.h"
#include "XPLMGraphics.h"
#include <string.h>
#if IBM
	#include <windows.h>
#endif
#if LIN
	#include <GL/gl.h>
#elif __GNUC__
	#include <OpenGL/gl.h>
#else
	#include <GL/gl.h>
#endif

#ifndef XPLM300
	#error This is made to be compiled against the XPLM300 SDK
#endif

// An opaque handle to the window we will create
static XPLMWindowID	g_window;

// Callbacks we will register when we create our window
void				draw_hello_world(XPLMWindowID in_window_id, void * in_refcon);
int					dummy_mouse_handler(XPLMWindowID in_window_id, int x, int y, int is_down, void * in_refcon) { return 0; }
XPLMCursorStatus	dummy_cursor_status_handler(XPLMWindowID in_window_id, int x, int y, void * in_refcon) { return xplm_CursorDefault; }
int					dummy_wheel_handler(XPLMWindowID in_window_id, int x, int y, int wheel, int clicks, void * in_refcon) { return 0; }
void				dummy_key_handler(XPLMWindowID in_window_id, char key, XPLMKeyFlags flags, char virtual_key, void * in_refcon, int losing_focus) { }

PLUGIN_API int XPluginStart(
							char *		outName,
							char *		outSig,
							char *		outDesc)
{
	strcpy(outName, "HelloWorld3Plugin");
	strcpy(outSig, "xpsdk.examples.helloworld3plugin");
	strcpy(outDesc, "A Hello World plug-in for the XPLM300 SDK.");
	
	XPLMCreateWindow_t params;
	params.structSize = sizeof(params);
	params.visible = 1;
	params.drawWindowFunc = draw_hello_world;
	// Note on "dummy" handlers:
	// Even if we don't want to handle these events, we have to register a "do-nothing" callback for them
	params.handleMouseClickFunc = dummy_mouse_handler;
	params.handleRightClickFunc = dummy_mouse_handler;
	params.handleMouseWheelFunc = dummy_wheel_handler;
	params.handleKeyFunc = dummy_key_handler;
	params.handleCursorFunc = dummy_cursor_status_handler;
	params.refcon = NULL;
	params.layer = xplm_WindowLayerFloatingWindows;
	// Opt-in to styling our window like an X-Plane 11 native window
	// If you're on XPLM300, not XPLM301, swap this enum for the literal value 1.
	params.decorateAsFloatingWindow = xplm_WindowDecorationRoundRectangle;
	
	// Set the window's initial bounds
	// Note that we're not guaranteed that the main monitor's lower left is at (0, 0)...
	// We'll need to query for the global desktop bounds!
	int left, bottom, right, top;
	XPLMGetScreenBoundsGlobal(&left, &top, &right, &bottom);
	params.left = left + 50;
	params.bottom = bottom + 150;
	params.right = params.left + 200;
	params.top = params.bottom + 200;
	
	g_window = XPLMCreateWindowEx(&params);
	
	// Position the window as a "free" floating window, which the user can drag around
	XPLMSetWindowPositioningMode(g_window, xplm_WindowPositionFree, -1);
	// Limit resizing our window: maintain a minimum width/height of 100 boxels and a max width/height of 300 boxels
	XPLMSetWindowResizingLimits(g_window, 200, 200, 300, 300);
	XPLMSetWindowTitle(g_window, "Sample Window");
	
	return g_window != NULL;
}

PLUGIN_API void	XPluginStop(void)
{
	// Since we created the window, we'll be good citizens and clean it up
	XPLMDestroyWindow(g_window);
	g_window = NULL;
}

PLUGIN_API void XPluginDisable(void) { }
PLUGIN_API int  XPluginEnable(void)  { return 1; }
PLUGIN_API void XPluginReceiveMessage(XPLMPluginID inFrom, int inMsg, void * inParam) { }

void	draw_hello_world(XPLMWindowID in_window_id, void * in_refcon)
{
	// Mandatory: We *must* set the OpenGL state before drawing
	// (we can't make any assumptions about it)
	XPLMSetGraphicsState(
						 0 /* no fog */,
						 0 /* 0 texture units */,
						 0 /* no lighting */,
						 0 /* no alpha testing */,
						 1 /* do alpha blend */,
						 1 /* do depth testing */,
						 0 /* no depth writing */
						 );
	
	int l, t, r, b;
	XPLMGetWindowGeometry(in_window_id, &l, &t, &r, &b);
	
	float col_white[] = {1.0, 1.0, 1.0}; // red, green, blue
	
	XPLMDrawString(col_white, l + 10, t - 20, "Hello world!", NULL, xplmFont_Proportional);
}
```

ä¾‹å¦‚ï¼Œä»£ç çš„æœ€åä¸€è¡Œçš„â€œHello world!â€æ˜¾ç„¶æ˜¯çª—å£æ˜¾ç¤ºçš„æ–‡å­—ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹æˆ"Hello X-Plane!"ï¼š

```cpp
XPLMDrawString(col_white, l + 10, t - 20, "Hello X-Plane!", NULL, xplmFont_Proportional);
```

åœ¨ä»£ç çš„73è¡Œå·¦å³æˆ‘ä»¬å¯ä»¥æ›´æ”¹çª—å£çš„æ ‡é¢˜ï¼š

```cpp
XPLMSetWindowTitle(g_window, "Sample Window");
```

å°†â€Sample Windowâ€æ”¹ä¸ºâ€Hello X-Planeâ€ :

```cpp
XPLMSetWindowTitle(g_window, "Hello X-Plane");
```

æ­¤æ—¶é‡æ–°æ„å»ºæ’ä»¶ï¼Œå°±å¯ä»¥å¾—åˆ°ç½®é¡¶æ•ˆæœå›¾ä¸­çš„æ ·å¼ã€‚

ä»£ç ä¸­è¿˜æœ‰å¾ˆå¤šå€¼å¾—ç©å‘³å’Œå°è¯•ä¿®æ”¹çš„åœ°æ–¹ï¼Œå¦‚æœ‰å…´è¶£ä¸å¦¨ä¸€è¯•ã€‚ä¾‹å¦‚ä»¥ä¸‹ä¸‰è¡Œä»£ç å¯ä»¥æ›´æ”¹æ’ä»¶è‡ªèº«çš„å±æ€§ï¼šæ’ä»¶åå­—ï¼Œç­¾åä»¥åŠæè¿°ç­‰ã€‚

```cpp
strcpy(outName, "HelloWorld3Plugin");
strcpy(outSig, "xpsdk.examples.helloworld3plugin");
strcpy(outDesc, "A Hello World plug-in for the XPLM300 SDK.");
```

![Untitled](Part%201%20-%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E4%BB%8B%E7%BB%8D%2061d09d19690c4856810e2b36029b5e4a/Untitled%2017.png)

<aside>
ğŸ’¡ æ³¨ï¼šè¯¥æ’ä»¶è™½ç„¶çœ‹ä¼¼ç®€å•ï¼Œä½†æ¶‰åŠåˆ°çª—å£ç»˜åˆ¶ä»¥åŠæ˜¾ç¤ºçš„åŠŸèƒ½ï¼Œè‹¥è¦ä»0å¼€å§‹å¼€å‘è¿˜æ˜¯æœ‰ä¸å°‘éš¾åº¦ã€‚è¿™ä¸ªç¤ºä¾‹ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿå¯¹æ’ä»¶æ„å»ºåŠå¼€å‘æµç¨‹æœ‰ä¸ªç›´è§‚æ„Ÿå—ã€‚ä¸‹ä¸€èŠ‚å°†ä»DataRefå¼€å§‹ç€æ‰‹XPçš„æ•°æ®è·å–å·¥ä½œã€‚XPå‡ ä¹æä¾›äº†ä¸€åˆ‡é£è¡Œå‚æ•°ï¼ŒåŒ…æ‹¬é£æœºå§¿æ€ã€è¿åŠ¨å­¦æ•°æ®ã€åŠ¨åŠ›å­¦æ•°æ®ã€èˆªç”µã€ä»ªè¡¨æ•°æ®ç­‰ï¼Œä»¥åŠå¦‚ä½•å¯¹å¯è¯»å†™æ•°æ®è¿›è¡Œæ›´æ”¹ï¼Œæœ‰äº†å®ƒä»¬å°±å¯ä»¥do everything you wantã€‚

</aside>